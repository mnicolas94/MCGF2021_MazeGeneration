name: tests

on:
  workflow_dispatch:

jobs:
  test:
    name: Testing
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - name: output
        id: versioning
        run: |
          echo "::set-output name=version::1.2.3" 
      - name: Tag
        run: |
          version=${{ steps.versioning.outputs.version }}-pre
          git tag v$version
          git push origin v$version
      - run: echo $version > version.txt
      - uses: actions/upload-artifact@v1
        with:
          name: version
          path: version.txt
      
  out:
    runs-on: ubuntu-latest
    name: output variable
    needs: test
    steps:
      - name: asd
        uses: actions/download-artifact@v1
        with:
          name: version
      - run: |
          value=$(cat version/version.txt)
          echo $value
          
        
